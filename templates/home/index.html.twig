{# templates/home/index.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}Bienvenue sur GSB Frais{% endblock %}

{% block body %}
    {{ form_start(form, {'attr': {'class': 'mb-4'}}) }}
    <div class="row align-items-end">
        <div class="col">
            {{ form_row(form.mois) }}
        </div>
        <div class="col-auto">
            <button type="submit" class="btn btn-primary">Rechercher</button>
        </div>
    </div>
    {{ form_end(form) }}

    {% if fiche is defined and fiche %}
        <div class="card mt-4">
            <div class="card-header">
                <h2 class="card-title">Fiche de frais du mois de {{ fiche.mois|date('m/Y') }}</h2>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <strong>État :</strong> {{ fiche.etat }}
                    <br>
                    <strong>Montant validé :</strong> {{ fiche.montantValide|default('Non validé') }} €
                </div>

                <table class="table table-striped">
                    <thead>
                    <tr>
                        <th>Type de frais</th>
                        <th>Quantité</th>
                        <th>Montant unitaire</th>
                        <th>Total</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for ligne in fiche.lignes %}
                        <tr>
                            <td>{{ ligne.type.libelle }}</td>
                            <td>{{ ligne.quantite }}</td>
                            <td>{{ ligne.type.montant }} €</td>
                            <td>{{ ligne.total }} €</td>
                        </tr>
                    {% endfor %}
                    </tbody>
                    <tfoot>
                    <tr>
                        <td colspan="3" class="text-end"><strong>Total de la fiche :</strong></td>
                        <td><strong>{{ fiche.montantTotal }} €</strong></td>
                    </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    {% elseif fiche is defined %}
        <div class="alert alert-info mt-4">
            Aucune fiche de frais trouvée pour ce mois.
        </div>
    {% endif %}
{% endblock %}